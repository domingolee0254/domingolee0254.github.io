---
title: "[딥러닝] 3. TensorFlow와 PyTorch의 특징과 차이"
author_profile: false
toc: true
toc_label: "Table of Contents"
toc_icon: true
toc_sticky: true
categories:
    - Deep Learning
tags:
    - Deep Learning
last_modified_at: 2024-12-23
---

# [딥러닝] 3. Tensorflow, PyTorch 특징과 차이가 뭘까요?

Status: Done

**#계산 그래프(Computational Graph) #정적vs동적 #언제 무엇을 사용해야 하는가**

# **1. TensorFlow**

- **정적 그래프**: 계산을 수행하기 전에 계산 그래프와 모든 연산, 변수, 데이터 흐름을 먼저 정의함. 이후에 그래프를 실행하는 방식
    - **컴파일**: 이 그래프는 컴파일된 후에 실행. 실행 과정에서는 그래프에 정의된 연산들이 순차적으로 수행. 그래프가 한 번 정의되고 컴파일되면, 그래프의 구조를 변경하는 것은 불가능
- 장점
    - **최적화**: 그래프가 미리 정의되어 있어, 메모리 재사용, 연산 병합, 불필요한 연산 제거 등을 적용할 수 있음.
    - **효율적인 배포**: 정적 그래프는 한번 생성되면 플랫폼 독립적으로 배포할 수 있어, 모바일이나 임베디드 시스템에서의 활용이 용이.
    - **분산 학습**: 정적 그래프는 여러 디바이스나 클러스터에 걸쳐 효율적으로 분산할 수 있음. 이는 대규모 데이터셋이나 모델을 처리할 때 유리.
- 단점
    - **유연성 부족**: 정적 그래프는 미리 정의된 구조를 사용하기 때문에, 실행 도중 모델을 수정하거나 동적으로 구조를 변경하기 어려움.

# 2. Pytorch

- **동적 그래프**: 연산이 호출될 때마다 그래프가 즉석에서 생성되고 실행. "정의-컴파일-실행"의 단계로 나뉘지 않고, "정의와 동시에 실행"
    - **유연성**: 연산은 실행 시점에서 정의됨, 실행 도중에도 그래프의 구조를 변경 가능.
- 장점
    - **유연성**: 복잡한 데이터 흐름을 처리하거나 실행 중에 모델의 구조를 변경하는 작업에 적합
    - **디버깅 용이성**: 실행과 동시에 그래프가 정의되기 때문에, 모델의 내부 상태를 즉시 확인 가능
- 단점
    - **최적화 제한**: 정적 그래프와 달리 실행 중에 생성되므로, 사전에 최적화하기 어려움. 성능 면에서 정적 그래프에 비해 비효율적일 수 있음.
    - **배포의 복잡성**: 실행 시점에 그래프가 생성되기 때문에, 이를 배포할 때는 실행 환경에서 그래프를 정의하고 실행할 수 있도록 해야하는데, 이는 정적 그래프에 비해 복잡하여 배포 시의 성능 하락할 수 있음.
    - **병렬 처리와 분산 학습의 제약:** 동적 그래프는 그래프 구조가 고정되지 않고 실행 중에 변화할 수 있기 때문에, 여러 GPU나 클러스터에서 병렬 처리나 분산 학습을 수행할 때 성능을 최적화하기 어렵습니다.

# 3. 차이점

- 정적: 계산 그래프 “정의-컴파일-실행” / 동적: 계산 그래프 "정의와 동시에 실행"

# 4. 선택 기준

- **프로젝트의 성격**:
    - 연구 중심: PyTorch의 동적 그래프가 더 유리(디버깅, 실험, 모델 구조 파악 등)
    - 대규모 배포: TensorFlow의 정적 그래프가 유리(실행 환경 최적화, 서비스 시 연산 최소화)

# 5. 추가

**PyTorch**: 처음부터 동적 그래프 방식을 채택하여 사용자가 모델을 정의하면서 즉시 실행할 수 있도록 했으나, TorchScript를 통해 정적 그래프의 일부 이점을 활용할 수 있도록 하는 기능을 추가함.